{% extends "base.html" %}
{% block title %}{{ program.title }} - ì •ë¶€ì§€ì›ì‚¬ì—… - Founderskorea{% endblock %}

{% block json_ld %}
<script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "GovernmentService",
    "name": "{{ program.title }}",
    "description": "{{ program.description[:200] }}",
    "provider": {"@type": "GovernmentOrganization", "name": "{{ program.organization }}"}
}
</script>
{% endblock %}

{% block head_extra %}
<script src="https://unpkg.com/htmx.org@1.9.12"></script>
<style>
/* Hero Banner Styles */
.program-hero {
    background: linear-gradient(135deg, #1B365D 0%, #0D7377 100%);
    color: white;
    padding: 3rem 2rem;
    border-radius: 16px;
    margin-bottom: 2rem;
    position: relative;
    overflow: hidden;
}
.program-hero::before {
    content: '';
    position: absolute;
    top: 0;
    right: 0;
    width: 300px;
    height: 300px;
    background: rgba(212, 168, 83, 0.1);
    border-radius: 50%;
    transform: translate(30%, -30%);
}
.hero-content {
    position: relative;
    z-index: 1;
}
.hero-header {
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    gap: 2rem;
    margin-bottom: 1.5rem;
}
.hero-title-section h1 {
    font-size: 2rem;
    font-weight: 800;
    margin: 0 0 0.75rem 0;
    line-height: 1.3;
}
.hero-organization {
    font-size: 1rem;
    opacity: 0.9;
    font-weight: 500;
}
.hero-status-badge {
    padding: 0.6rem 1.2rem;
    border-radius: 50px;
    font-weight: 700;
    font-size: 0.95rem;
    white-space: nowrap;
    box-shadow: 0 4px 12px rgba(0,0,0,0.15);
}
.hero-status-badge.active {
    background: #D4A853;
    color: #1B365D;
}
.hero-status-badge.closed {
    background: rgba(255,255,255,0.2);
    color: white;
    border: 2px solid rgba(255,255,255,0.5);
}
.hero-dday {
    display: inline-block;
    background: rgba(255,255,255,0.15);
    backdrop-filter: blur(10px);
    padding: 0.5rem 1rem;
    border-radius: 8px;
    font-size: 0.9rem;
    font-weight: 600;
    margin-top: 0.5rem;
}

/* Key Info Grid */
.key-info-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 1.5rem;
    margin-bottom: 3rem;
}
.key-info-card {
    background: white;
    border: 2px solid #f0f0f0;
    border-radius: 12px;
    padding: 1.5rem;
    transition: all 0.3s ease;
}
.key-info-card:hover {
    border-color: #0D7377;
    box-shadow: 0 4px 16px rgba(13, 115, 119, 0.1);
    transform: translateY(-2px);
}
.key-info-label {
    font-size: 0.8rem;
    color: #666;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    margin-bottom: 0.5rem;
}
.key-info-value {
    font-size: 1.25rem;
    font-weight: 700;
    color: #1B365D;
    line-height: 1.4;
}
.key-info-card.highlight .key-info-value {
    color: #D4A853;
    font-size: 1.5rem;
}

/* Section Styles */
.detail-section {
    background: white;
    border-radius: 12px;
    padding: 2rem;
    margin-bottom: 2rem;
    border: 1px solid #e5e7eb;
}
.section-header {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    margin-bottom: 1.5rem;
}
.section-icon {
    width: 36px;
    height: 36px;
    background: linear-gradient(135deg, #0D7377, #1B365D);
    border-radius: 8px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1.2rem;
}
.section-title {
    font-size: 1.4rem;
    font-weight: 700;
    color: #1B365D;
    margin: 0;
}

/* Eligibility Requirements */
.eligibility-list {
    list-style: none;
    padding: 0;
    margin: 0;
}
.eligibility-list li {
    padding: 1rem 1rem 1rem 3rem;
    margin-bottom: 0.75rem;
    background: #f9fafb;
    border-radius: 8px;
    border-left: 4px solid #0D7377;
    position: relative;
}
.eligibility-list li::before {
    content: 'âœ“';
    position: absolute;
    left: 1rem;
    color: #0D7377;
    font-weight: 700;
    font-size: 1.2rem;
}

/* Timeline */
.application-timeline {
    position: relative;
    padding-left: 2rem;
}
.timeline-item {
    position: relative;
    padding-bottom: 2rem;
}
.timeline-item:last-child {
    padding-bottom: 0;
}
.timeline-item::before {
    content: '';
    position: absolute;
    left: -1.5rem;
    top: 0;
    width: 12px;
    height: 12px;
    background: #0D7377;
    border: 3px solid white;
    border-radius: 50%;
    box-shadow: 0 0 0 2px #0D7377;
}
.timeline-item:not(:last-child)::after {
    content: '';
    position: absolute;
    left: -1.125rem;
    top: 12px;
    width: 2px;
    height: calc(100% - 12px);
    background: #e5e7eb;
}
.timeline-step {
    font-weight: 700;
    color: #1B365D;
    margin-bottom: 0.25rem;
}
.timeline-desc {
    color: #666;
    font-size: 0.9rem;
}

/* Support Details */
.support-benefits {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 1rem;
}
.benefit-card {
    background: linear-gradient(135deg, #f9fafb 0%, #ffffff 100%);
    border: 2px solid #f0f0f0;
    border-radius: 12px;
    padding: 1.5rem;
    text-align: center;
}
.benefit-icon {
    font-size: 2rem;
    margin-bottom: 0.75rem;
}
.benefit-title {
    font-weight: 700;
    color: #1B365D;
    margin-bottom: 0.5rem;
}
.benefit-desc {
    font-size: 0.9rem;
    color: #666;
}

/* CTA Section */
.cta-section {
    background: linear-gradient(135deg, #1B365D 0%, #0D7377 100%);
    border-radius: 16px;
    padding: 2.5rem;
    text-align: center;
    color: white;
    margin: 3rem 0;
}
.cta-title {
    font-size: 1.5rem;
    font-weight: 700;
    margin-bottom: 1rem;
}
.cta-subtitle {
    font-size: 1rem;
    opacity: 0.9;
    margin-bottom: 2rem;
}
.cta-buttons {
    display: flex;
    gap: 1rem;
    justify-content: center;
    flex-wrap: wrap;
}
.cta-btn {
    padding: 1rem 2rem;
    border-radius: 50px;
    font-weight: 700;
    font-size: 1rem;
    text-decoration: none;
    transition: all 0.3s ease;
    display: inline-flex;
    align-items: center;
    gap: 0.5rem;
}
.cta-btn-primary {
    background: #D4A853;
    color: #1B365D;
}
.cta-btn-primary:hover {
    background: #e5b963;
    transform: translateY(-2px);
    box-shadow: 0 8px 20px rgba(212, 168, 83, 0.3);
}
.cta-btn-secondary {
    background: rgba(255,255,255,0.15);
    color: white;
    border: 2px solid rgba(255,255,255,0.5);
}
.cta-btn-secondary:hover {
    background: rgba(255,255,255,0.25);
    transform: translateY(-2px);
}

/* Similar Programs */
.similar-programs-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
    gap: 1.5rem;
}
.similar-program-card {
    background: white;
    border: 2px solid #f0f0f0;
    border-radius: 12px;
    padding: 1.5rem;
    transition: all 0.3s ease;
    text-decoration: none;
    color: inherit;
    display: block;
}
.similar-program-card:hover {
    border-color: #0D7377;
    box-shadow: 0 8px 24px rgba(13, 115, 119, 0.12);
    transform: translateY(-4px);
}
.similar-program-title {
    font-weight: 700;
    color: #1B365D;
    margin-bottom: 0.5rem;
    font-size: 1.1rem;
}
.similar-program-org {
    color: #666;
    font-size: 0.85rem;
    margin-bottom: 0.75rem;
}
.similar-program-tags {
    display: flex;
    gap: 0.5rem;
    flex-wrap: wrap;
}
.similar-tag {
    padding: 0.25rem 0.75rem;
    background: #f0f0f0;
    border-radius: 20px;
    font-size: 0.75rem;
    color: #666;
}

@media (max-width: 768px) {
    .program-hero {
        padding: 2rem 1.5rem;
    }
    .hero-header {
        flex-direction: column;
        align-items: flex-start;
    }
    .hero-title-section h1 {
        font-size: 1.5rem;
    }
    .key-info-grid {
        grid-template-columns: 1fr;
    }
    .cta-buttons {
        flex-direction: column;
    }
    .cta-btn {
        width: 100%;
        justify-content: center;
    }
}
</style>
{% endblock %}

{% block content %}
<div class="container-narrow">
    <a href="/gov-support/db" class="back" style="display: inline-flex; align-items: center; gap: 0.4rem; color: var(--text-secondary); font-size: 0.85rem; margin-bottom: 1.5rem; font-weight: 500; text-decoration: none;">&larr; ì§€ì›ì‚¬ì—… ëª©ë¡ìœ¼ë¡œ</a>

    <!-- Hero Banner -->
    <div class="program-hero">
        <div class="hero-content">
            <div class="hero-header">
                <div class="hero-title-section">
                    <h1>{{ program.title }}</h1>
                    <p class="hero-organization">{{ program.organization }}</p>
                </div>
                <div>
                    {% if program.status == 'ëª¨ì§‘ì¤‘' %}
                    <div class="hero-status-badge active">ëª¨ì§‘ì¤‘</div>
                    {% else %}
                    <div class="hero-status-badge closed">ë§ˆê°</div>
                    {% endif %}
                    {% if program.deadline and program.status == 'ëª¨ì§‘ì¤‘' %}
                    <div class="hero-dday">
                        ğŸ“… D-{{ (program.deadline - now).days if (program.deadline - now).days > 0 else 'day' }}
                    </div>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>

    <!-- Key Info Grid -->
    <div class="key-info-grid">
        {% if program.funding_amount %}
        <div class="key-info-card highlight">
            <div class="key-info-label">ì§€ì›ê¸ˆì•¡</div>
            <div class="key-info-value">{{ program.funding_amount }}</div>
        </div>
        {% endif %}

        <div class="key-info-card">
            <div class="key-info-label">ì§€ì›ìœ í˜•</div>
            <div class="key-info-value">{{ program.support_type or 'ì •ì±…ìê¸ˆ' }}</div>
        </div>

        <div class="key-info-card">
            <div class="key-info-label">ëŒ€ìƒì§€ì—­</div>
            <div class="key-info-value">{{ program.region or 'ì „êµ­' }}</div>
        </div>

        {% if program.deadline %}
        <div class="key-info-card">
            <div class="key-info-label">ëª¨ì§‘ê¸°ê°„</div>
            <div class="key-info-value">~ {{ program.deadline.strftime('%Y.%m.%d') }}</div>
        </div>
        {% endif %}

        <div class="key-info-card">
            <div class="key-info-label">ì£¼ê´€ê¸°ê´€</div>
            <div class="key-info-value" style="font-size: 1rem;">{{ program.organization }}</div>
        </div>
    </div>

    <!-- Program Description -->
    <div class="detail-section">
        <div class="section-header">
            <div class="section-icon">ğŸ“‹</div>
            <h2 class="section-title">ì‚¬ì—… ê°œìš”</h2>
        </div>
        <div class="post-content">
            {% if program.description_html %}
                {{ program.description_html | safe }}
            {% else %}
                <p style="line-height: 1.8; color: #374151;">{{ program.description }}</p>
            {% endif %}
        </div>
    </div>

    <!-- Eligibility Requirements -->
    {% if program.eligibility %}
    <div class="detail-section">
        <div class="section-header">
            <div class="section-icon">âœ“</div>
            <h2 class="section-title">ì‹ ì²­ ìê²©</h2>
        </div>
        <ul class="eligibility-list">
            {% for requirement in program.eligibility.split('\n') if requirement.strip() %}
            <li>{{ requirement.strip() }}</li>
            {% endfor %}
        </ul>
    </div>
    {% endif %}

    <!-- Application Process Timeline -->
    <div class="detail-section">
        <div class="section-header">
            <div class="section-icon">ğŸ”„</div>
            <h2 class="section-title">ì‹ ì²­ ì ˆì°¨</h2>
        </div>
        <div class="application-timeline">
            <div class="timeline-item">
                <div class="timeline-step">1ë‹¨ê³„: ì‚¬ì—…ê³µê³  ë° ì ‘ìˆ˜</div>
                <div class="timeline-desc">ì˜¨ë¼ì¸ ì‹ ì²­ì„œ ì‘ì„± ë° í•„ìˆ˜ ì„œë¥˜ ì œì¶œ</div>
            </div>
            <div class="timeline-item">
                <div class="timeline-step">2ë‹¨ê³„: ì„œë¥˜ì‹¬ì‚¬</div>
                <div class="timeline-desc">ì œì¶œ ì„œë¥˜ ë° ì‹ ì²­ ìê²© ê²€í† </div>
            </div>
            <div class="timeline-item">
                <div class="timeline-step">3ë‹¨ê³„: ë°œí‘œí‰ê°€ (í•´ë‹¹ì‹œ)</div>
                <div class="timeline-desc">ì‚¬ì—…ê³„íš ë°œí‘œ ë° ì „ë¬¸ê°€ í‰ê°€</div>
            </div>
            <div class="timeline-item">
                <div class="timeline-step">4ë‹¨ê³„: ìµœì¢…ì„ ì • ë°œí‘œ</div>
                <div class="timeline-desc">ì„ ì • ê²°ê³¼ í†µë³´ ë° í˜‘ì•½ ì•ˆë‚´</div>
            </div>
            <div class="timeline-item">
                <div class="timeline-step">5ë‹¨ê³„: í˜‘ì•½ ì²´ê²°</div>
                <div class="timeline-desc">ì‚¬ì—… ìˆ˜í–‰ í˜‘ì•½ ë° ì§€ì›ê¸ˆ ì§€ê¸‰</div>
            </div>
        </div>
    </div>

    <!-- Support Details -->
    <div class="detail-section">
        <div class="section-header">
            <div class="section-icon">ğŸ’</div>
            <h2 class="section-title">ì§€ì› í˜œíƒ</h2>
        </div>
        <div class="support-benefits">
            <div class="benefit-card">
                <div class="benefit-icon">ğŸ’°</div>
                <div class="benefit-title">ì‚¬ì—…í™” ìê¸ˆ</div>
                <div class="benefit-desc">ì œí’ˆ ê°œë°œ ë° ì‚¬ì—…í™”ë¥¼ ìœ„í•œ ì§ì ‘ ì§€ì›ê¸ˆ</div>
            </div>
            <div class="benefit-card">
                <div class="benefit-icon">ğŸ“</div>
                <div class="benefit-title">ì „ë¬¸ ì»¨ì„¤íŒ…</div>
                <div class="benefit-desc">ë¶„ì•¼ë³„ ì „ë¬¸ê°€ ë©˜í† ë§ ë° êµìœ¡ í”„ë¡œê·¸ë¨</div>
            </div>
            <div class="benefit-card">
                <div class="benefit-icon">ğŸ¤</div>
                <div class="benefit-title">ë„¤íŠ¸ì›Œí‚¹</div>
                <div class="benefit-desc">íˆ¬ììÂ·ê¸°ì—… ì—°ê³„ ë° IR ê¸°íšŒ ì œê³µ</div>
            </div>
            <div class="benefit-card">
                <div class="benefit-icon">ğŸ¢</div>
                <div class="benefit-title">ê³µê°„ ì§€ì›</div>
                <div class="benefit-desc">ì‚¬ë¬´ê³µê°„ ë° ì‹œì„¤ ì‚¬ìš© ì§€ì›</div>
            </div>
        </div>
    </div>

    <!-- Application Kit (if exists) -->
    {% if program.application_kit %}
    <div class="detail-section">
        <div class="section-header">
            <div class="section-icon">ğŸ“¦</div>
            <h2 class="section-title">ì‹ ì²­ í‚¤íŠ¸</h2>
        </div>
        {% if program.application_kit.checklist_html %}
        <div style="margin-bottom: 1.5rem;">
            <h3 style="font-size: 1.1rem; font-weight: 700; color: #1B365D; margin-bottom: 1rem;">ì²´í¬ë¦¬ìŠ¤íŠ¸</h3>
            {{ program.application_kit.checklist_html | safe }}
        </div>
        {% endif %}
        {% if program.application_kit.guide_html %}
        <div class="post-content">
            {{ program.application_kit.guide_html | safe }}
        </div>
        {% endif %}
    </div>
    {% endif %}

    <!-- CTA Section -->
    <div class="cta-section">
        <h2 class="cta-title">ì§€ê¸ˆ ë°”ë¡œ ì‹ ì²­í•˜ì„¸ìš”</h2>
        <p class="cta-subtitle">ë‹¹ì‹ ì˜ ë¹„ì¦ˆë‹ˆìŠ¤ë¥¼ ë‹¤ìŒ ë‹¨ê³„ë¡œ ëŒì–´ì˜¬ë¦´ ê¸°íšŒì…ë‹ˆë‹¤</p>
        <div class="cta-buttons">
            {% if program.apply_url %}
            <a href="{{ program.apply_url }}" target="_blank" rel="noopener" class="cta-btn cta-btn-primary">
                ì‹ ì²­í•˜ê¸° â†’
            </a>
            {% endif %}
            <a href="/gov-support/db" class="cta-btn cta-btn-secondary">
                ğŸ¤– AI ë§¤ì¹­ìœ¼ë¡œ ë” ì°¾ê¸°
            </a>
        </div>
    </div>

    <!-- Similar Programs -->
    <div class="detail-section">
        <div class="section-header">
            <div class="section-icon">ğŸ”</div>
            <h2 class="section-title">ë¹„ìŠ·í•œ ì§€ì›ì‚¬ì—…</h2>
        </div>
        <p style="color: #666; margin-bottom: 1.5rem;">ì´ ì‚¬ì—…ê³¼ ìœ ì‚¬í•œ ë‹¤ë¥¸ ì§€ì› í”„ë¡œê·¸ë¨ì„ í™•ì¸í•´ë³´ì„¸ìš”</p>
        <div style="text-align: center; padding: 2rem;">
            <a href="/gov-support/db" class="cta-btn cta-btn-secondary" style="display: inline-flex; background: #1B365D; border: none;">
                ì „ì²´ ì§€ì›ì‚¬ì—… ë‘˜ëŸ¬ë³´ê¸° â†’
            </a>
        </div>
    </div>

    <!-- Community Reviews -->
    <div class="detail-section">
        <div class="section-header">
            <div class="section-icon">ğŸ’¬</div>
            <h2 class="section-title">ì»¤ë®¤ë‹ˆí‹° ë¦¬ë·°</h2>
        </div>
        <div id="reviewSection">
            {% include "gov_support/_reviews.html" %}
        </div>

        <div class="review-form" style="margin-top: 2rem; padding: 2rem; background: #f9fafb; border-radius: 12px;">
            <h3 style="font-size: 1.2rem; font-weight: 700; color: #1B365D; margin-bottom: 1.5rem;">ë¦¬ë·° ë‚¨ê¸°ê¸°</h3>
            <form hx-post="/gov-support/db/{{ program.id }}/review" hx-target="#reviewSection" hx-swap="innerHTML">
                <div class="form-group">
                    <label>ë‹‰ë„¤ì„</label>
                    <input type="text" name="nickname" placeholder="ìµëª…" maxlength="100">
                </div>
                <div class="form-group">
                    <label>ë³„ì </label>
                    <div class="star-rating">
                        <input type="radio" name="rating" value="5" id="star5"><label for="star5">&#9733;</label>
                        <input type="radio" name="rating" value="4" id="star4"><label for="star4">&#9733;</label>
                        <input type="radio" name="rating" value="3" id="star3" checked><label for="star3">&#9733;</label>
                        <input type="radio" name="rating" value="2" id="star2"><label for="star2">&#9733;</label>
                        <input type="radio" name="rating" value="1" id="star1"><label for="star1">&#9733;</label>
                    </div>
                </div>
                <div class="form-group">
                    <label>ê²°ê³¼</label>
                    <select name="success_tag">
                        <option value="">ì„ íƒì•ˆí•¨</option>
                        <option value="ì„ ì •ë¨">ì„ ì •ë¨</option>
                        <option value="íƒˆë½">íƒˆë½</option>
                        <option value="ì§„í–‰ì¤‘">ì§„í–‰ì¤‘</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>ë¦¬ë·° ë‚´ìš©</label>
                    <textarea name="content" placeholder="ì´ ì‚¬ì—…ì— ëŒ€í•œ ê²½í—˜ì„ ê³µìœ í•´ì£¼ì„¸ìš”..." required></textarea>
                </div>
                <div class="form-group">
                    <label>ê¿€íŒ (ì„ íƒ)</label>
                    <textarea name="tip" placeholder="ì‹ ì²­ ì‹œ ë„ì›€ë˜ëŠ” íŒì´ ìˆë‹¤ë©´ ê³µìœ í•´ì£¼ì„¸ìš”..." style="min-height: 60px;"></textarea>
                </div>
                <button type="submit" class="btn btn-primary" style="background: #1B365D; padding: 0.75rem 2rem; border-radius: 8px;">ë¦¬ë·° ë“±ë¡</button>
            </form>
        </div>
    </div>
</div>

<script>
// D-day calculation fallback if template var not available
document.addEventListener('DOMContentLoaded', function() {
    const ddayElement = document.querySelector('.hero-dday');
    if (ddayElement && ddayElement.textContent.includes('now')) {
        ddayElement.style.display = 'none';
    }
});
</script>
{% endblock %}
